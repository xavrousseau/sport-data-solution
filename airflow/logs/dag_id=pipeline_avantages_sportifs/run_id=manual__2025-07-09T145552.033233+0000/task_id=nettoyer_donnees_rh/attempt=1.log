[2025-07-09T14:55:53.188+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-09T14:55:53.211+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pipeline_avantages_sportifs.nettoyer_donnees_rh manual__2025-07-09T14:55:52.033233+00:00 [queued]>
[2025-07-09T14:55:53.217+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pipeline_avantages_sportifs.nettoyer_donnees_rh manual__2025-07-09T14:55:52.033233+00:00 [queued]>
[2025-07-09T14:55:53.218+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-09T14:55:53.229+0000] {taskinstance.py:2327} INFO - Executing <Task(BashOperator): nettoyer_donnees_rh> on 2025-07-09 14:55:52.033233+00:00
[2025-07-09T14:55:53.235+0000] {standard_task_runner.py:63} INFO - Started process 66 to run task
[2025-07-09T14:55:53.238+0000] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'pipeline_avantages_sportifs', 'nettoyer_donnees_rh', 'manual__2025-07-09T14:55:52.033233+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag_pipeline_avantages.py', '--cfg-path', '/tmp/tmpayrxt04l']
[2025-07-09T14:55:53.240+0000] {standard_task_runner.py:91} INFO - Job 4: Subtask nettoyer_donnees_rh
[2025-07-09T14:55:53.285+0000] {task_command.py:426} INFO - Running <TaskInstance: pipeline_avantages_sportifs.nettoyer_donnees_rh manual__2025-07-09T14:55:52.033233+00:00 [running]> on host c19735a04e2b
[2025-07-09T14:55:53.348+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='xavier' AIRFLOW_CTX_DAG_ID='pipeline_avantages_sportifs' AIRFLOW_CTX_TASK_ID='nettoyer_donnees_rh' AIRFLOW_CTX_EXECUTION_DATE='2025-07-09T14:55:52.033233+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-07-09T14:55:52.033233+00:00'
[2025-07-09T14:55:53.350+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-09T14:55:53.374+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-07-09T14:55:53.376+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/airflow/scripts/nettoyer_donnees_rh.py']
[2025-07-09T14:55:53.388+0000] {subprocess.py:86} INFO - Output:
[2025-07-09T14:55:59.145+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.145 | INFO     | __main__:pipeline_nettoyage_rh:271 - === D√©marrage du pipeline de nettoyage RH ===
[2025-07-09T14:55:59.146+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.145 | INFO     | minio_helper:__init__:49 - üì° Connexion MinIO ‚Üí http://sport-minio:9000 | Bucket : sportdata
[2025-07-09T14:55:59.245+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.245 | SUCCESS  | __main__:pipeline_nettoyage_rh:282 - ‚úÖ Fichier RH t√©l√©charg√© : referentiels/donnees_rh.xlsx
[2025-07-09T14:55:59.410+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.410 | INFO     | __main__:pipeline_nettoyage_rh:292 - Fichier RH charg√© (161 lignes)
[2025-07-09T14:55:59.411+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.410 | INFO     | __main__:analyse_exploratoire_avancee:132 -
[2025-07-09T14:55:59.412+0000] {subprocess.py:93} INFO - ================================================================================
[2025-07-09T14:55:59.412+0000] {subprocess.py:93} INFO - Analyse exploratoire RH (brut, normalis√©)
[2025-07-09T14:55:59.413+0000] {subprocess.py:93} INFO - ================================================================================
[2025-07-09T14:55:59.414+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.410 | INFO     | __main__:analyse_exploratoire_avancee:133 - Nombre de lignes        : 161
[2025-07-09T14:55:59.416+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.410 | INFO     | __main__:analyse_exploratoire_avancee:134 - Nombre de colonnes      : 11
[2025-07-09T14:55:59.416+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.411 | INFO     | __main__:analyse_exploratoire_avancee:135 - Colonnes disponibles    : ['id_salarie', 'nom', 'prenom', 'date_de_naissance', 'bu', 'date_d_embauche', 'salaire_brut', 'type_de_contrat', 'nombre_de_jours_de_cp', 'adresse_du_domicile', 'moyen_de_deplacement']
[2025-07-09T14:55:59.417+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.411 | INFO     | __main__:analyse_exploratoire_avancee:136 -
[2025-07-09T14:55:59.417+0000] {subprocess.py:93} INFO - --- Valeurs manquantes par colonne ---
[2025-07-09T14:55:59.418+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.411 | INFO     | __main__:analyse_exploratoire_avancee:137 - id_salarie               0
[2025-07-09T14:55:59.419+0000] {subprocess.py:93} INFO - nom                      0
[2025-07-09T14:55:59.419+0000] {subprocess.py:93} INFO - prenom                   0
[2025-07-09T14:55:59.420+0000] {subprocess.py:93} INFO - date_de_naissance        0
[2025-07-09T14:55:59.421+0000] {subprocess.py:93} INFO - bu                       0
[2025-07-09T14:55:59.421+0000] {subprocess.py:93} INFO - date_d_embauche          0
[2025-07-09T14:55:59.422+0000] {subprocess.py:93} INFO - salaire_brut             0
[2025-07-09T14:55:59.422+0000] {subprocess.py:93} INFO - type_de_contrat          0
[2025-07-09T14:55:59.423+0000] {subprocess.py:93} INFO - nombre_de_jours_de_cp    0
[2025-07-09T14:55:59.423+0000] {subprocess.py:93} INFO - adresse_du_domicile      0
[2025-07-09T14:55:59.423+0000] {subprocess.py:93} INFO - moyen_de_deplacement     0
[2025-07-09T14:55:59.424+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.411 | INFO     | __main__:analyse_exploratoire_avancee:138 -
[2025-07-09T14:55:59.424+0000] {subprocess.py:93} INFO - --- Unicit√© par colonne (nb valeurs uniques) ---
[2025-07-09T14:55:59.424+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.413 | INFO     | __main__:analyse_exploratoire_avancee:139 - id_salarie               161
[2025-07-09T14:55:59.425+0000] {subprocess.py:93} INFO - date_de_naissance        160
[2025-07-09T14:55:59.425+0000] {subprocess.py:93} INFO - salaire_brut             159
[2025-07-09T14:55:59.425+0000] {subprocess.py:93} INFO - adresse_du_domicile      159
[2025-07-09T14:55:59.426+0000] {subprocess.py:93} INFO - date_d_embauche          154
[2025-07-09T14:55:59.426+0000] {subprocess.py:93} INFO - nom                      130
[2025-07-09T14:55:59.426+0000] {subprocess.py:93} INFO - prenom                   113
[2025-07-09T14:55:59.427+0000] {subprocess.py:93} INFO - bu                         5
[2025-07-09T14:55:59.427+0000] {subprocess.py:93} INFO - nombre_de_jours_de_cp      5
[2025-07-09T14:55:59.428+0000] {subprocess.py:93} INFO - moyen_de_deplacement       4
[2025-07-09T14:55:59.429+0000] {subprocess.py:93} INFO - type_de_contrat            2
[2025-07-09T14:55:59.429+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.414 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.430+0000] {subprocess.py:93} INFO - ==> Colonne : id_salarie
[2025-07-09T14:55:59.431+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.414 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : int64
[2025-07-09T14:55:59.432+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.414 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : [59019 19841 56482 21886 81001]
[2025-07-09T14:55:59.432+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.417 | INFO     | __main__:analyse_exploratoire_avancee:148 - Stats num√©riques :
[2025-07-09T14:55:59.433+0000] {subprocess.py:93} INFO - count      161.000000
[2025-07-09T14:55:59.434+0000] {subprocess.py:93} INFO - mean     52622.024845
[2025-07-09T14:55:59.435+0000] {subprocess.py:93} INFO - std      24202.833930
[2025-07-09T14:55:59.436+0000] {subprocess.py:93} INFO - min      12497.000000
[2025-07-09T14:55:59.437+0000] {subprocess.py:93} INFO - 25%      33386.000000
[2025-07-09T14:55:59.437+0000] {subprocess.py:93} INFO - 50%      49804.000000
[2025-07-09T14:55:59.438+0000] {subprocess.py:93} INFO - 75%      71657.000000
[2025-07-09T14:55:59.439+0000] {subprocess.py:93} INFO - max      99514.000000
[2025-07-09T14:55:59.440+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.417 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.855+0000] {subprocess.py:93} INFO - ==> Colonne : nom
[2025-07-09T14:55:59.856+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.417 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : object
[2025-07-09T14:55:59.856+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.417 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : ['Colin' 'Ledoux' 'Dumont' 'Toussaint' 'Bailly']
[2025-07-09T14:55:59.858+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.418 | INFO     | __main__:analyse_exploratoire_avancee:146 - Top 5 valeurs fr√©quentes :
[2025-07-09T14:55:59.858+0000] {subprocess.py:93} INFO - nom
[2025-07-09T14:55:59.859+0000] {subprocess.py:93} INFO - Marchand     4
[2025-07-09T14:55:59.860+0000] {subprocess.py:93} INFO - Toussaint    3
[2025-07-09T14:55:59.861+0000] {subprocess.py:93} INFO - Munoz        3
[2025-07-09T14:55:59.861+0000] {subprocess.py:93} INFO - Lacroix      3
[2025-07-09T14:55:59.862+0000] {subprocess.py:93} INFO - Devaux       3
[2025-07-09T14:55:59.862+0000] {subprocess.py:93} INFO - Name: count, dtype: int64
[2025-07-09T14:55:59.863+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.419 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.863+0000] {subprocess.py:93} INFO - ==> Colonne : prenom
[2025-07-09T14:55:59.864+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.419 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : object
[2025-07-09T14:55:59.864+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.419 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : ['Audrey' 'Monique' 'Michelle' 'Judith' 'Margaret']
[2025-07-09T14:55:59.865+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.419 | INFO     | __main__:analyse_exploratoire_avancee:146 - Top 5 valeurs fr√©quentes :
[2025-07-09T14:55:59.865+0000] {subprocess.py:93} INFO - prenom
[2025-07-09T14:55:59.866+0000] {subprocess.py:93} INFO - Alain       4
[2025-07-09T14:55:59.866+0000] {subprocess.py:93} INFO - William     3
[2025-07-09T14:55:59.866+0000] {subprocess.py:93} INFO - Michelle    3
[2025-07-09T14:55:59.867+0000] {subprocess.py:93} INFO - Benjamin    3
[2025-07-09T14:55:59.867+0000] {subprocess.py:93} INFO - Julien      3
[2025-07-09T14:55:59.868+0000] {subprocess.py:93} INFO - Name: count, dtype: int64
[2025-07-09T14:55:59.868+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.420 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.868+0000] {subprocess.py:93} INFO - ==> Colonne : date_de_naissance
[2025-07-09T14:55:59.869+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.420 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : datetime64[ns]
[2025-07-09T14:55:59.869+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.421 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : <DatetimeArray>
[2025-07-09T14:55:59.870+0000] {subprocess.py:93} INFO - ['1990-07-06 00:00:00', '1962-01-06 00:00:00', '1976-08-09 00:00:00',
[2025-07-09T14:55:59.870+0000] {subprocess.py:93} INFO -  '1962-09-10 00:00:00', '1975-04-20 00:00:00']
[2025-07-09T14:55:59.871+0000] {subprocess.py:93} INFO - Length: 5, dtype: datetime64[ns]
[2025-07-09T14:55:59.871+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.421 | INFO     | __main__:analyse_exploratoire_avancee:150 - Exemples de dates : ['1990-07-06' '1962-01-06' '1976-08-09' '1962-09-10' '1975-04-20']
[2025-07-09T14:55:59.872+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.422 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.872+0000] {subprocess.py:93} INFO - ==> Colonne : bu
[2025-07-09T14:55:59.873+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.422 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : object
[2025-07-09T14:55:59.873+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.422 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : ['Marketing' 'R&D' 'Ventes' 'Support' 'Finance']
[2025-07-09T14:55:59.874+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.423 | INFO     | __main__:analyse_exploratoire_avancee:146 - Top 5 valeurs fr√©quentes :
[2025-07-09T14:55:59.874+0000] {subprocess.py:93} INFO - bu
[2025-07-09T14:55:59.875+0000] {subprocess.py:93} INFO - Finance      42
[2025-07-09T14:55:59.875+0000] {subprocess.py:93} INFO - Support      35
[2025-07-09T14:55:59.875+0000] {subprocess.py:93} INFO - Ventes       33
[2025-07-09T14:55:59.876+0000] {subprocess.py:93} INFO - R&D          26
[2025-07-09T14:55:59.876+0000] {subprocess.py:93} INFO - Marketing    25
[2025-07-09T14:55:59.877+0000] {subprocess.py:93} INFO - Name: count, dtype: int64
[2025-07-09T14:55:59.877+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.423 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.878+0000] {subprocess.py:93} INFO - ==> Colonne : date_d_embauche
[2025-07-09T14:55:59.878+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.423 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : datetime64[ns]
[2025-07-09T14:55:59.879+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.423 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : <DatetimeArray>
[2025-07-09T14:55:59.879+0000] {subprocess.py:93} INFO - ['2020-12-14 00:00:00', '2020-07-07 00:00:00', '2022-03-29 00:00:00',
[2025-07-09T14:55:59.879+0000] {subprocess.py:93} INFO -  '2021-12-12 00:00:00', '2025-02-19 00:00:00']
[2025-07-09T14:55:59.880+0000] {subprocess.py:93} INFO - Length: 5, dtype: datetime64[ns]
[2025-07-09T14:55:59.880+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.424 | INFO     | __main__:analyse_exploratoire_avancee:150 - Exemples de dates : ['2020-12-14' '2020-07-07' '2022-03-29' '2021-12-12' '2025-02-19']
[2025-07-09T14:55:59.880+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.424 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.881+0000] {subprocess.py:93} INFO - ==> Colonne : salaire_brut
[2025-07-09T14:55:59.881+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.424 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : int64
[2025-07-09T14:55:59.881+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.424 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : [30940 74360 51390 70320 46870]
[2025-07-09T14:55:59.882+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.426 | INFO     | __main__:analyse_exploratoire_avancee:148 - Stats num√©riques :
[2025-07-09T14:55:59.883+0000] {subprocess.py:93} INFO - count      161.000000
[2025-07-09T14:55:59.883+0000] {subprocess.py:93} INFO - mean     50426.273292
[2025-07-09T14:55:59.884+0000] {subprocess.py:93} INFO - std      14779.614627
[2025-07-09T14:55:59.885+0000] {subprocess.py:93} INFO - min      25570.000000
[2025-07-09T14:55:59.885+0000] {subprocess.py:93} INFO - 25%      37910.000000
[2025-07-09T14:55:59.886+0000] {subprocess.py:93} INFO - 50%      50580.000000
[2025-07-09T14:55:59.887+0000] {subprocess.py:93} INFO - 75%      62760.000000
[2025-07-09T14:55:59.887+0000] {subprocess.py:93} INFO - max      74990.000000
[2025-07-09T14:55:59.888+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.426 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.888+0000] {subprocess.py:93} INFO - ==> Colonne : type_de_contrat
[2025-07-09T14:55:59.889+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.426 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : object
[2025-07-09T14:55:59.889+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.426 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : ['CDI' 'CDD']
[2025-07-09T14:55:59.890+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.427 | INFO     | __main__:analyse_exploratoire_avancee:146 - Top 5 valeurs fr√©quentes :
[2025-07-09T14:55:59.890+0000] {subprocess.py:93} INFO - type_de_contrat
[2025-07-09T14:55:59.890+0000] {subprocess.py:93} INFO - CDI    149
[2025-07-09T14:55:59.891+0000] {subprocess.py:93} INFO - CDD     12
[2025-07-09T14:55:59.891+0000] {subprocess.py:93} INFO - Name: count, dtype: int64
[2025-07-09T14:55:59.892+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.427 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.892+0000] {subprocess.py:93} INFO - ==> Colonne : nombre_de_jours_de_cp
[2025-07-09T14:55:59.893+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.427 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : int64
[2025-07-09T14:55:59.893+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.427 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : [29 26 27 25 28]
[2025-07-09T14:55:59.893+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.428 | INFO     | __main__:analyse_exploratoire_avancee:148 - Stats num√©riques :
[2025-07-09T14:55:59.894+0000] {subprocess.py:93} INFO - count    161.000000
[2025-07-09T14:55:59.894+0000] {subprocess.py:93} INFO - mean      26.950311
[2025-07-09T14:55:59.894+0000] {subprocess.py:93} INFO - std        1.456886
[2025-07-09T14:55:59.895+0000] {subprocess.py:93} INFO - min       25.000000
[2025-07-09T14:55:59.895+0000] {subprocess.py:93} INFO - 25%       26.000000
[2025-07-09T14:55:59.895+0000] {subprocess.py:93} INFO - 50%       27.000000
[2025-07-09T14:55:59.896+0000] {subprocess.py:93} INFO - 75%       28.000000
[2025-07-09T14:55:59.896+0000] {subprocess.py:93} INFO - max       29.000000
[2025-07-09T14:55:59.896+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.428 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.897+0000] {subprocess.py:93} INFO - ==> Colonne : adresse_du_domicile
[2025-07-09T14:55:59.897+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.429 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : object
[2025-07-09T14:55:59.897+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.429 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : ['128 Rue du Port, 34000 Frontignan'
[2025-07-09T14:55:59.898+0000] {subprocess.py:93} INFO -  '68 Rue du Port, 34970 Saint-Cl√©ment-de-Rivi√®re'
[2025-07-09T14:55:59.898+0000] {subprocess.py:93} INFO -  '100 Av. de la Gare, 30900 N√Æmes' '53 Av. de la Gare, 34970 Lattes'
[2025-07-09T14:55:59.898+0000] {subprocess.py:93} INFO -  '74 Rue des Fleurs, 34970 Lattes']
[2025-07-09T14:55:59.899+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.429 | INFO     | __main__:analyse_exploratoire_avancee:146 - Top 5 valeurs fr√©quentes :
[2025-07-09T14:55:59.899+0000] {subprocess.py:93} INFO - adresse_du_domicile
[2025-07-09T14:55:59.899+0000] {subprocess.py:93} INFO - Pl. de la Libert√©, 34470 P√©rols              2
[2025-07-09T14:55:59.900+0000] {subprocess.py:93} INFO - Rue du Ctre, 34160 Saint-Dr√©z√©ry             2
[2025-07-09T14:55:59.900+0000] {subprocess.py:93} INFO - 103 All. des Pins, 34170 Castelnau-le-Lez    1
[2025-07-09T14:55:59.901+0000] {subprocess.py:93} INFO - 121 Bd des Sports, 34000 Montpellier         1
[2025-07-09T14:55:59.901+0000] {subprocess.py:93} INFO - 6 Rue des Bougainvilliers, 34970 Lattes      1
[2025-07-09T14:55:59.901+0000] {subprocess.py:93} INFO - Name: count, dtype: int64
[2025-07-09T14:55:59.902+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.429 | INFO     | __main__:analyse_exploratoire_avancee:142 -
[2025-07-09T14:55:59.902+0000] {subprocess.py:93} INFO - ==> Colonne : moyen_de_deplacement
[2025-07-09T14:55:59.903+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.429 | INFO     | __main__:analyse_exploratoire_avancee:143 - Type : object
[2025-07-09T14:55:59.903+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.430 | INFO     | __main__:analyse_exploratoire_avancee:144 - Valeurs uniques (5 premi√®res) : ['Transports en commun' 'v√©hicule thermique/√©lectrique' 'Marche/running'
[2025-07-09T14:55:59.904+0000] {subprocess.py:93} INFO -  'V√©lo/Trottinette/Autres']
[2025-07-09T14:55:59.905+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.430 | INFO     | __main__:analyse_exploratoire_avancee:146 - Top 5 valeurs fr√©quentes :
[2025-07-09T14:55:59.905+0000] {subprocess.py:93} INFO - moyen_de_deplacement
[2025-07-09T14:55:59.906+0000] {subprocess.py:93} INFO - v√©hicule thermique/√©lectrique    73
[2025-07-09T14:55:59.906+0000] {subprocess.py:93} INFO - V√©lo/Trottinette/Autres          54
[2025-07-09T14:55:59.907+0000] {subprocess.py:93} INFO - Transports en commun             20
[2025-07-09T14:55:59.907+0000] {subprocess.py:93} INFO - Marche/running                   14
[2025-07-09T14:55:59.908+0000] {subprocess.py:93} INFO - Name: count, dtype: int64
[2025-07-09T14:55:59.908+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.430 | INFO     | __main__:analyse_exploratoire_avancee:151 -
[2025-07-09T14:55:59.909+0000] {subprocess.py:93} INFO - --- Aper√ßu des 10 premi√®res lignes ---
[2025-07-09T14:55:59.909+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.434 | INFO     | __main__:analyse_exploratoire_avancee:152 -
[2025-07-09T14:55:59.910+0000] {subprocess.py:93} INFO -    id_salarie        nom    prenom date_de_naissance         bu date_d_embauche  salaire_brut type_de_contrat  nombre_de_jours_de_cp                             adresse_du_domicile           moyen_de_deplacement
[2025-07-09T14:55:59.910+0000] {subprocess.py:93} INFO - 0       59019      Colin    Audrey        1990-07-06  Marketing      2020-12-14         30940             CDI                     29               128 Rue du Port, 34000 Frontignan           Transports en commun
[2025-07-09T14:55:59.910+0000] {subprocess.py:93} INFO - 1       19841     Ledoux   Monique        1962-01-06        R&D      2020-07-07         74360             CDI                     26  68 Rue du Port, 34970 Saint-Cl√©ment-de-Rivi√®re  v√©hicule thermique/√©lectrique
[2025-07-09T14:55:59.910+0000] {subprocess.py:93} INFO - 2       56482     Dumont  Michelle        1976-08-09     Ventes      2022-03-29         51390             CDI                     27                 100 Av. de la Gare, 30900 N√Æmes  v√©hicule thermique/√©lectrique
[2025-07-09T14:55:59.911+0000] {subprocess.py:93} INFO - 3       21886  Toussaint    Judith        1962-09-10    Support      2021-12-12         70320             CDI                     29                 53 Av. de la Gare, 34970 Lattes                 Marche/running
[2025-07-09T14:55:59.911+0000] {subprocess.py:93} INFO - 4       81001     Bailly  Michelle        1975-04-20     Ventes      2025-02-19         46870             CDD                     29                 74 Rue des Fleurs, 34970 Lattes                 Marche/running
[2025-07-09T14:55:59.911+0000] {subprocess.py:93} INFO - 5       17757      Bazin  Margaret        1982-11-24    Support      2023-04-17         31460             CDI                     25                     Av. de La Mer, 34470 P√©rols        V√©lo/Trottinette/Autres
[2025-07-09T14:55:59.911+0000] {subprocess.py:93} INFO - 6       17036    Jacques    Julien        1970-12-19  Marketing      2021-08-21         72480             CDI                     29                      28 Rue du Port, 34140 M√®ze  v√©hicule thermique/√©lectrique
[2025-07-09T14:55:59.912+0000] {subprocess.py:93} INFO - 7       36913       Pons  Brigitte        1977-12-27    Finance      2020-05-26         59790             CDI                     28        169 Rue Jean Jaures, 34730 Prades-le-Lez           Transports en commun
[2025-07-09T14:55:59.912+0000] {subprocess.py:93} INFO - 8       79006    Rousset    J√©rome        1979-02-01        R&D      2020-09-07         29240             CDI                     28         44 Rue Jean Jaures, 34730 Prades-le-Lez  v√©hicule thermique/√©lectrique
[2025-07-09T14:55:59.912+0000] {subprocess.py:93} INFO - 9       62296    Chauvin   Zakaria        1987-10-02    Finance      2024-11-23         68680             CDD                     26          31 Av. Grassion Cibrand, 34130 Mauguio        V√©lo/Trottinette/Autres
[2025-07-09T14:55:59.913+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.434 | INFO     | __main__:analyse_exploratoire_avancee:153 -
[2025-07-09T14:55:59.913+0000] {subprocess.py:93} INFO - --- Aper√ßu des 10 derni√®res lignes ---
[2025-07-09T14:55:59.913+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.436 | INFO     | __main__:analyse_exploratoire_avancee:154 -
[2025-07-09T14:55:59.913+0000] {subprocess.py:93} INFO -      id_salarie       nom     prenom date_de_naissance         bu date_d_embauche  salaire_brut type_de_contrat  nombre_de_jours_de_cp                               adresse_du_domicile           moyen_de_deplacement
[2025-07-09T14:55:59.913+0000] {subprocess.py:93} INFO - 151       82858     Colas   Nathalie        1970-12-30  Marketing      2023-04-19         31820             CDI                     25            125 Rue du Port, 34280 La Grande-Motte        V√©lo/Trottinette/Autres
[2025-07-09T14:55:59.914+0000] {subprocess.py:93} INFO - 152       50955    Godard    Margaud        1992-05-23    Support      2022-03-29         67480             CDI                     25                        99 Rue du N, 34920 Le Cr√®s        V√©lo/Trottinette/Autres
[2025-07-09T14:55:59.914+0000] {subprocess.py:93} INFO - 153       43965    Tanguy  Timoth√É¬©e        1986-06-15     Ventes      2024-02-07         54180             CDI                     27                  100 Av. de la Gare, 34970 Lattes                 Marche/running
[2025-07-09T14:55:59.914+0000] {subprocess.py:93} INFO - 154       42960   Normand     Michel        1994-10-26     Ventes      2025-01-10         26320             CDD                     29         17 Rue Maguelone, 34250 Palavas-les-Flots        V√©lo/Trottinette/Autres
[2025-07-09T14:55:59.914+0000] {subprocess.py:93} INFO - 155       13780    Renard    Sylvain        1982-11-29    Finance      2024-04-11         60200             CDI                     25                56 Imp. Robespierre, 34130 Mauguio        V√©lo/Trottinette/Autres
[2025-07-09T14:55:59.915+0000] {subprocess.py:93} INFO - 156       18941   Guillou     Gilles        1986-12-23    Finance      2025-02-27         59910             CDI                     29  68 Bd des √âcoles, 34750 Villeneuve-l√®s-Maguelone        V√©lo/Trottinette/Autres
[2025-07-09T14:55:59.915+0000] {subprocess.py:93} INFO - 157       81676    Breton   Jeannine        1966-06-24     Ventes      2022-01-22         48430             CDI                     29           27 Av. du G√©n√©ral Leclerc, 34470 P√©rols                 Marche/running
[2025-07-09T14:55:59.915+0000] {subprocess.py:93} INFO - 158       27069  Delahaye   Philippe        1996-09-10    Support      2020-11-27         56380             CDI                     29         59 Chem. des Pins, 34170 Castelnau-le-Lez  v√©hicule thermique/√©lectrique
[2025-07-09T14:55:59.915+0000] {subprocess.py:93} INFO - 159       30256     Dumas     Odette        1960-12-22     Ventes      2023-04-08         45170             CDI                     29                      2 Rue du Nord, 34920 Le Cr√®s  v√©hicule thermique/√©lectrique
[2025-07-09T14:55:59.916+0000] {subprocess.py:93} INFO - 160       94680    Pineau      Henri        1973-11-16  Marketing      2025-01-24         64180             CDD                     26            5 Av. de la Libert√©, 34070 Montpellier        V√©lo/Trottinette/Autres
[2025-07-09T14:55:59.916+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.436 | INFO     | __main__:analyse_exploratoire_avancee:158 -
[2025-07-09T14:55:59.916+0000] {subprocess.py:93} INFO - == Audit mapping modes de transport ==
[2025-07-09T14:55:59.916+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.436 | INFO     | __main__:analyse_exploratoire_avancee:163 - Mode trouv√©: 'Marche/running' --> mapping projet: 'marche'
[2025-07-09T14:55:59.917+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.436 | INFO     | __main__:analyse_exploratoire_avancee:163 - Mode trouv√©: 'Transports en commun' --> mapping projet: 'None'
[2025-07-09T14:55:59.917+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.436 | INFO     | __main__:analyse_exploratoire_avancee:163 - Mode trouv√©: 'V√©lo/Trottinette/Autres' --> mapping projet: 'v√©lo'
[2025-07-09T14:55:59.918+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.436 | INFO     | __main__:analyse_exploratoire_avancee:163 - Mode trouv√©: 'v√©hicule thermique/√©lectrique' --> mapping projet: 'None'
[2025-07-09T14:55:59.919+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.436 | WARNING  | __main__:analyse_exploratoire_avancee:167 - Modes non reconnus √† compl√©ter dans le mapping: ['Transports en commun', 'v√©hicule thermique/√©lectrique']
[2025-07-09T14:55:59.919+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.437 | INFO     | __main__:analyse_exploratoire_avancee:168 - R√©partition des modes de transport:
[2025-07-09T14:55:59.919+0000] {subprocess.py:93} INFO - moyen_de_deplacement
[2025-07-09T14:55:59.920+0000] {subprocess.py:93} INFO - v√©hicule thermique/√©lectrique    73
[2025-07-09T14:55:59.920+0000] {subprocess.py:93} INFO - V√©lo/Trottinette/Autres          54
[2025-07-09T14:55:59.920+0000] {subprocess.py:93} INFO - Transports en commun             20
[2025-07-09T14:55:59.920+0000] {subprocess.py:93} INFO - Marche/running                   14
[2025-07-09T14:55:59.921+0000] {subprocess.py:93} INFO - 2025-07-09 14:55:59.437 | INFO     | __main__:pipeline_nettoyage_rh:307 - Calcul des distances et filtrage des √©ligibilit√©s‚Ä¶ (peut √™tre long selon la taille)
[2025-07-09T14:56:13.708+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.708 | INFO     | __main__:pipeline_nettoyage_rh:332 - 68 salari√©s √©ligibles / 93 exclus.
[2025-07-09T14:56:13.712+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.708 | INFO     | __main__:pipeline_nettoyage_rh:336 - Validation de la qualit√© avec Great Expectations‚Ä¶
[2025-07-09T14:56:13.713+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.710 | INFO     | __main__:pipeline_nettoyage_rh:367 - Test expectation: expect_column_values_to_not_be_null -- {'column': 'id_salarie'}
[2025-07-09T14:56:13.719+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.711 | INFO     | __main__:pipeline_nettoyage_rh:378 - ‚úÖ OK: expect_column_values_to_not_be_null
[2025-07-09T14:56:13.720+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.711 | INFO     | __main__:pipeline_nettoyage_rh:367 - Test expectation: expect_column_values_to_not_be_null -- {'column': 'nom'}
[2025-07-09T14:56:13.721+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.712 | INFO     | __main__:pipeline_nettoyage_rh:378 - ‚úÖ OK: expect_column_values_to_not_be_null
[2025-07-09T14:56:13.723+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.712 | INFO     | __main__:pipeline_nettoyage_rh:367 - Test expectation: expect_column_values_to_not_be_null -- {'column': 'prenom'}
[2025-07-09T14:56:13.732+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.712 | INFO     | __main__:pipeline_nettoyage_rh:378 - ‚úÖ OK: expect_column_values_to_not_be_null
[2025-07-09T14:56:13.733+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.712 | INFO     | __main__:pipeline_nettoyage_rh:367 - Test expectation: expect_column_values_to_not_be_null -- {'column': 'adresse_du_domicile'}
[2025-07-09T14:56:13.733+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.713 | INFO     | __main__:pipeline_nettoyage_rh:378 - ‚úÖ OK: expect_column_values_to_not_be_null
[2025-07-09T14:56:13.734+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.713 | INFO     | __main__:pipeline_nettoyage_rh:367 - Test expectation: expect_column_values_to_not_be_null -- {'column': 'distance_km'}
[2025-07-09T14:56:13.735+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.714 | INFO     | __main__:pipeline_nettoyage_rh:378 - ‚úÖ OK: expect_column_values_to_not_be_null
[2025-07-09T14:56:13.735+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.714 | INFO     | __main__:pipeline_nettoyage_rh:367 - Test expectation: expect_column_values_to_be_between -- {'column': 'distance_km', 'min_value': 0, 'max_value': 100}
[2025-07-09T14:56:13.736+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.714 | INFO     | __main__:pipeline_nettoyage_rh:378 - ‚úÖ OK: expect_column_values_to_be_between
[2025-07-09T14:56:13.737+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.714 | INFO     | __main__:pipeline_nettoyage_rh:367 - Test expectation: expect_column_values_to_be_of_type -- {'column': 'distance_km', 'type_': 'float64'}
[2025-07-09T14:56:13.745+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.715 | INFO     | __main__:pipeline_nettoyage_rh:378 - ‚úÖ OK: expect_column_values_to_be_of_type
[2025-07-09T14:56:13.747+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.715 | SUCCESS  | __main__:pipeline_nettoyage_rh:383 - ‚úÖ Validation Great Expectations r√©ussie : toutes les expectations sont remplies.
[2025-07-09T14:56:13.762+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.762 | SUCCESS  | __main__:upload_excel_to_minio:398 - ‚úÖ Fichier RH nettoy√© (√©ligibles) upload√© sur MinIO : raw/donnees_rh_cleaned.xlsx
[2025-07-09T14:56:13.781+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.781 | SUCCESS  | __main__:upload_excel_to_minio:398 - ‚úÖ Fichier RH exclus upload√© sur MinIO : raw/donnees_rh_exclus.xlsx
[2025-07-09T14:56:13.821+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.820 | SUCCESS  | __main__:pipeline_nettoyage_rh:412 - ‚úÖ Donn√©es √©ligibles ins√©r√©es dans PostgreSQL ('employes')
[2025-07-09T14:56:13.822+0000] {subprocess.py:93} INFO - 2025-07-09 14:56:13.821 | INFO     | __main__:pipeline_nettoyage_rh:416 - === Pipeline nettoyage RH termin√© ===
[2025-07-09T14:56:14.473+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-07-09T14:56:14.474+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-09T14:56:14.493+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=pipeline_avantages_sportifs, task_id=nettoyer_donnees_rh, execution_date=20250709T145552, start_date=20250709T145553, end_date=20250709T145614
[2025-07-09T14:56:14.560+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-09T14:56:14.580+0000] {taskinstance.py:3482} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-07-09T14:56:14.582+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
